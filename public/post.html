<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Post</title>
    <meta name="description" content="Read our latest articles about invoice creation, templates, and business tips.">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="">
    <meta property="og:title" content="Blog Post">
    <meta property="og:description" content="Read our latest articles about invoice creation, templates, and business tips.">
    <meta property="og:image" content="/images/og-image.jpg">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="">
    <meta property="twitter:title" content="Blog Post">
    <meta property="twitter:description" content="Read our latest articles about invoice creation, templates, and business tips.">
    <meta property="twitter:image" content="/images/og-image.jpg">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="">
    
    <!-- Additional Meta Tags -->
    <meta name="author" content="FreeOnlineInvoice.org">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    
    <link rel="stylesheet" href="/styles.min.css">
    <link rel="stylesheet" href="/styles.css">
    <!-- Removed Supabase scripts; posts now load purely from static post-data.js -->
</head>
<body class="post-page">
    <header class="site-header">
        <div class="header-inner">
            <h1 class="site-title"><a href="index.html">Free online invoice</a></h1>
        </div>
    </header>

    <!-- Navigation Menu -->
    <nav class="main-nav">
        <div class="nav-container">
                <ul class="nav-menu">
                    <li class="nav-item">
                        <a href="index.html" class="nav-link">Invoice Generator</a>
                    </li>
                    <li class="nav-item">
                        <a href="blog.html" class="nav-link">Blog & Help</a>
                    </li>
                    <li class="nav-item">
                        <a href="articles.html" class="nav-link">All Articles</a>
                    </li>
                    <li class="nav-item">
                        <a href="how-to-use-invoice-generator.html" class="nav-link">How to Use Guide</a>
                    </li>
                </ul>
            </div>
        </nav>
    <main class="site-container">
        <div class="post-container">
            <div id="post-content">
                <!-- Post content will be loaded here by post-data.js -->
            </div>
        </div>
    </main>
    <footer class="blog-footer">
        <p><a href="blog.html">← Back to Blog</a></p>
    </footer>
    <script src="post-data.js"></script>
    <script>
    // 动态渲染文章内容并注入 JSON-LD（Article/BlogPosting）
    (function () {
        function getParam(name) {
            try {
                var params = new URLSearchParams(window.location.search);
                return params.get(name);
            } catch (e) { return null; }
        }
        function stripHtml(html) {
            if (!html) return '';
            var div = document.createElement('div');
            div.innerHTML = html;
            return (div.textContent || div.innerText || '').trim();
        }
        function truncate(text, maxLen) {
            if (!text) return '';
            if (text.length <= maxLen) return text;
            return text.slice(0, maxLen - 1) + '…';
        }
        function setMeta(selector, attr, value) {
            var el = document.querySelector(selector);
            if (el && value) el.setAttribute(attr, value);
        }

        var slug = getParam('slug');
        var data = (typeof staticArticles !== 'undefined') ? staticArticles : null;
        var article = (slug && data) ? data[slug] : null;

        var container = document.getElementById('post-content');
        if (!article) {
            if (container) {
                container.innerHTML = '<h1>Article Not Found</h1><p>The requested article could not be located. Please return to the <a href="articles.html">Articles</a> page.</p>';
            }
            return;
        }

        // 渲染内容
        var title = article.meta_title || article.title || 'Blog Post';
        var descPlain = stripHtml(article.meta_description || article.description || '');
        var pageUrl = (window.location && window.location.href) ? window.location.href : '';
        var imageUrl = (window.location && window.location.origin) ? (window.location.origin + '/images/og-image.jpg') : '/images/og-image.jpg';
        var authorName = article.author || 'FreeOnlineInvoice.org';

        document.title = title;
        // 由 post-data.js 负责完整的文章布局与容器渲染，这里不再直接写入内容，避免覆盖样式结构
        // if (container) { /* no-op */ }

        // 更新常用 meta/OG/Twitter
        setMeta('meta[name="description"]', 'content', truncate(descPlain, 300));
        setMeta('meta[property="og:title"]', 'content', title);
        setMeta('meta[property="og:description"]', 'content', truncate(descPlain, 200));
        setMeta('meta[property="og:url"]', 'content', pageUrl);
        setMeta('meta[property="og:image"]', 'content', imageUrl);
        setMeta('meta[property="twitter:title"]', 'content', title);
        setMeta('meta[property="twitter:description"]', 'content', truncate(descPlain, 200));
        setMeta('meta[property="twitter:url"]', 'content', pageUrl);
        setMeta('meta[property="twitter:image"]', 'content', imageUrl);
        setMeta('link[rel="canonical"]', 'href', pageUrl);
        setMeta('meta[name="author"]', 'content', authorName);

        // 注入 JSON-LD（Article/BlogPosting）
        var jsonLd = {
            "@context": "https://schema.org",
            "@type": "BlogPosting",
            "headline": title,
            "description": truncate(descPlain, 350),
            "datePublished": article.published_at || '',
            "author": { "@type": "Person", "name": authorName },
            "image": imageUrl,
            "mainEntityOfPage": { "@type": "WebPage", "@id": pageUrl },
            "articleSection": article.category || 'blog',
            "keywords": Array.isArray(article.tags) ? article.tags : []
        };
        var s = document.createElement('script');
        s.type = 'application/ld+json';
        s.text = JSON.stringify(jsonLd);
        document.head.appendChild(s);
    })();
    </script>
</body>
</html>
